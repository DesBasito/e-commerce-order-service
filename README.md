# Order Service

## ğŸ“‹ ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ

Order Service - ÑÑ‚Ğ¾ Ñ†ĞµĞ½Ñ‚Ñ€Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¼Ğ¸ĞºÑ€Ğ¾ÑĞµÑ€Ğ²Ğ¸Ñ Ğ´Ğ»Ñ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ·Ğ°ĞºĞ°Ğ·Ğ°Ğ¼Ğ¸ Ğ² e-commerce ÑĞ¸ÑÑ‚ĞµĞ¼Ğµ. ĞĞ½ ĞºĞ¾Ğ¾Ñ€Ğ´Ğ¸Ğ½Ğ¸Ñ€ÑƒĞµÑ‚ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ğ·Ğ°ĞºĞ°Ğ·Ğ°, Ğ²Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ´ĞµĞ¹ÑÑ‚Ğ²ÑƒÑ Ñ Ğ´Ñ€ÑƒĞ³Ğ¸Ğ¼Ğ¸ ÑĞµÑ€Ğ²Ğ¸ÑĞ°Ğ¼Ğ¸ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ¾Ğ², Ñ€ĞµĞ·ĞµÑ€Ğ²Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ñ‚Ğ¾Ğ²Ğ°Ñ€Ğ¾Ğ², Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹ Ğ¸ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ¸ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ğ¹.

## ğŸ¯ ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸

- Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ½Ğ¾Ğ²Ñ‹Ñ… Ğ·Ğ°ĞºĞ°Ğ·Ğ¾Ğ²
- Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ·Ğ°ĞºĞ°Ğ·Ğ°
- Ğ’Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ Ñ Customer Service Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ¾Ğ²
- Ğ’Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ Ñ Product Service Ğ´Ğ»Ñ Ñ€ĞµĞ·ĞµÑ€Ğ²Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ñ‚Ğ¾Ğ²Ğ°Ñ€Ğ¾Ğ²
- Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ Payment Service Ğ´Ğ»Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹
- ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ğ¹ Ñ‡ĞµÑ€ĞµĞ· Kafka
- Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Order Lines (Ğ´ĞµÑ‚Ğ°Ğ»Ğ¸ Ğ·Ğ°ĞºĞ°Ğ·Ğ°)
- ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ ÑĞ¿Ğ¸ÑĞºĞ° Ğ·Ğ°ĞºĞ°Ğ·Ğ¾Ğ² Ğ¸ Ğ´ĞµÑ‚Ğ°Ğ»ĞµĞ¹

## âš™ï¸ Ğ¢ĞµÑ…Ğ½Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ ÑÑ‚ĞµĞº

- **Java 17**
- **Spring Boot 3.5.3**
- **Spring Data JPA**
- **Spring Cloud OpenFeign** (Ğ´Ğ»Ñ Ğ¼ĞµĞ¶ÑĞµÑ€Ğ²Ğ¸ÑĞ½Ğ¾Ğ³Ğ¾ Ğ²Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ)
- **Spring Cloud Config Client**
- **Spring Cloud Netflix Eureka Client**
- **Spring Kafka** (Ğ´Ğ»Ñ Ğ°ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ½Ñ‹Ñ… ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ğ¹)
- **PostgreSQL**
- **Lombok**
- **Maven**

## ğŸ—„ï¸ ĞœĞ¾Ğ´ĞµĞ»ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

### Order Entity
```java
@Entity
public class Order {
    @Id
    @GeneratedValue
    private Integer id;
    
    @Column(unique = true, nullable = false)
    private String reference;
    
    private BigDecimal totalAmount;
    
    @Enumerated(EnumType.STRING)
    private PaymentMethod paymentMethod;
    
    private String customerId;
    
    @OneToMany(mappedBy = "order")
    private List<OrderLine> orderLines;
    
    @CreatedDate
    private LocalDateTime createdDate;
    
    @LastModifiedDate
    private LocalDateTime lastModifiedDate;
}
```

### OrderLine Entity
```java
@Entity
@Table(name = "customer_line")
public class OrderLine {
    @Id
    @GeneratedValue
    private Integer id;
    
    @ManyToOne
    @JoinColumn(name = "order_id")
    private Order order;
    
    private Integer productId;
    private double quantity;
}
```

### PaymentMethod Enum
```java
public enum PaymentMethod {
    PAYPAL,
    CREDIT_CARD,
    VISA,
    MASTER_CARD,
    BITCOIN
}
```

## ğŸš€ Ğ—Ğ°Ğ¿ÑƒÑĞº ÑĞµÑ€Ğ²Ğ¸ÑĞ°

### ĞŸÑ€ĞµĞ´Ğ²Ğ°Ñ€Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ ÑƒÑĞ»Ğ¾Ğ²Ğ¸Ñ
- Config Server (http://localhost:8888)
- Discovery Service (http://localhost:8761)
- Customer Service (http://localhost:8090)
- Product Service (http://localhost:8050)
- Payment Service
- PostgreSQL (localhost:5555)
- Kafka (Ğ´Ğ»Ñ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ğ¹)
- Java 17+
- Maven 3.6+

### Ğ›Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ·Ğ°Ğ¿ÑƒÑĞº

```bash
# ĞšĞ»Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ñ
git clone <repository-url>
cd services/order

# Ğ¡Ğ±Ğ¾Ñ€ĞºĞ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°
./mvnw clean install

# Ğ—Ğ°Ğ¿ÑƒÑĞº ÑĞµÑ€Ğ²Ğ¸ÑĞ°
./mvnw spring-boot:run
```

## ğŸ”§ ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ

### application.yml
```yaml
spring:
  config:
    import: optional:configserver:http://localhost:8888
  application:
    name: order-service
```

### order-service.yml (Ğ² Config Server)
```yaml
spring:
  datasource:
    url: jdbc:postgresql://localhost:5555/order
    username: qwe
    password: qwe
    driver-class-name: org.postgresql.Driver
  jpa:
    hibernate:
      ddl-auto: update
    database: postgresql
    database-platform: org.hibernate.dialect.PostgreSQLDialect

application:
  config:
    customer-url: http://localhost:8090/api/v1/customer
    product-url: http://localhost:8050/api/v1/products
    payment-url: http://localhost:8080/api/v1/payments

server:
  port: 8070
```

## ğŸŒ API Endpoints

### Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ°ĞºĞ°Ğ·Ğ°
```http
POST /api/v1/orders
Content-Type: application/json

{
  "reference": "ORD-2024-001",
  "amount": 2899.97,
  "paymentMethod": "CREDIT_CARD",
  "customerId": "507f1f77bcf86cd799439011",
  "products": [
    {
      "productId": 1,
      "quantity": 2
    },
    {
      "productId": 2,
      "quantity": 1
    }
  ]
}
```

**ĞÑ‚Ğ²ĞµÑ‚:**
```json
15
```

### ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ²ÑĞµÑ… Ğ·Ğ°ĞºĞ°Ğ·Ğ¾Ğ²
```http
GET /api/v1/orders
```

**ĞÑ‚Ğ²ĞµÑ‚:**
```json
[
  {
    "id": 15,
    "reference": "ORD-2024-001",
    "amount": 2899.97,
    "paymentMethod": "CREDIT_CARD",
    "customerId": "507f1f77bcf86cd799439011"
  }
]
```

### ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ·Ğ°ĞºĞ°Ğ·Ğ° Ğ¿Ğ¾ ID
```http
GET /api/v1/orders/{order-id}
```

**ĞÑ‚Ğ²ĞµÑ‚:**
```json
{
  "id": 15,
  "reference": "ORD-2024-001", 
  "amount": 2899.97,
  "paymentMethod": "CREDIT_CARD",
  "customerId": "507f1f77bcf86cd799439011"
}
``` 

### ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Order Lines Ğ¿Ğ¾ ID Ğ·Ğ°ĞºĞ°Ğ·Ğ°
```http
GET /api/v1/order-lines/order/{order-id}
```

**ĞÑ‚Ğ²ĞµÑ‚:**
```json
[
  {
    "id": 25,
    "quantity": 2.0
  },
  {
    "id": 26,
    "quantity": 1.0
  }
]
```

## ğŸ—ï¸ ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

### Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ğ°ĞºĞµÑ‚Ğ¾Ğ²
```
kg.manurov.ecommerce/
â”œâ”€â”€ controller/
â”‚   â”œâ”€â”€ OrderController.java
â”‚   â””â”€â”€ OrderLineController.java
â”œâ”€â”€ dto/
â”‚   â”œâ”€â”€ order/
â”‚   â”‚   â”œâ”€â”€ OrderRequest.java
â”‚   â”‚   â””â”€â”€ OrderResponse.java
â”‚   â””â”€â”€ orderLine/
â”‚       â”œâ”€â”€ OrderLineRequest.java
â”‚       â””â”€â”€ OrderLineResponse.java
â”œâ”€â”€ feign/
â”‚   â”œâ”€â”€ customer/
â”‚   â”‚   â”œâ”€â”€ CustomerClient.java
â”‚   â”‚   â””â”€â”€ CustomerResponse.java
â”‚   â”œâ”€â”€ payment/
â”‚   â”‚   â”œâ”€â”€ PaymentClient.java
â”‚   â”‚   â””â”€â”€ PaymentRequest.java
â”‚   â””â”€â”€ product/
â”‚       â”œâ”€â”€ ProductClient.java
â”‚       â”œâ”€â”€ PurchaseRequest.java
â”‚       â””â”€â”€ PurchaseResponse.java
â”œâ”€â”€ kafka/
â”‚   â”œâ”€â”€ OrderConfirmation.java
â”‚   â””â”€â”€ OrderProducer.java
â”œâ”€â”€ mapper/
â”‚   â”œâ”€â”€ OrderMapper.java
â”‚   â””â”€â”€ OrderLineMapper.java
â”œâ”€â”€ order/
â”‚   â”œâ”€â”€ Order.java
â”‚   â”œâ”€â”€ OrderLine.java
â”‚   â””â”€â”€ PaymentMethod.java
â”œâ”€â”€ repositories/
â”‚   â”œâ”€â”€ OrderRepository.java
â”‚   â””â”€â”€ OrderLineRepository.java
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ OrderService.java
â”‚   â””â”€â”€ OrderLineService.java
â””â”€â”€ OrderApplication.java
```

## ğŸ”„ ĞŸÑ€Ğ¾Ñ†ĞµÑÑ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ğ·Ğ°ĞºĞ°Ğ·Ğ°

### ĞŸĞ¾ÑˆĞ°Ğ³Ğ¾Ğ²Ñ‹Ğ¹ Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼:

1. **Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°** - Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ·Ğ°ĞºĞ°Ğ·Ğ°
2. **ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ°** - Ğ²Ñ‹Ğ·Ğ¾Ğ² Customer Service Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ ÑÑƒÑ‰ĞµÑÑ‚Ğ²Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ°
3. **Ğ ĞµĞ·ĞµÑ€Ğ²Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ‚Ğ¾Ğ²Ğ°Ñ€Ğ¾Ğ²** - Ğ²Ñ‹Ğ·Ğ¾Ğ² Product Service Ğ´Ğ»Ñ Ğ¿Ğ¾ĞºÑƒĞ¿ĞºĞ¸ Ñ‚Ğ¾Ğ²Ğ°Ñ€Ğ¾Ğ²
4. **Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ°ĞºĞ°Ğ·Ğ°** - ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ·Ğ°ĞºĞ°Ğ·Ğ° Ğ² Ğ±Ğ°Ğ·Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
5. **Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Order Lines** - ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ´ĞµÑ‚Ğ°Ğ»ĞµĞ¹ Ğ·Ğ°ĞºĞ°Ğ·Ğ°
6. **ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶Ğ°** - Ğ²Ñ‹Ğ·Ğ¾Ğ² Payment Service
7. **ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ** - Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ Ğ² Kafka

### ĞšĞ¾Ğ´ OrderService.createOrder():
```java
@Transactional
public Integer createOrder(OrderRequest request) {
    // 1. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ°
    CustomerResponse customer = customerClient.findCustomerById(request.customerId())
            .orElseThrow(() -> new BusinessException("Cannot create order:: No customer exists with the provided ID"));

    // 2. Ğ ĞµĞ·ĞµÑ€Ğ²Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ‚Ğ¾Ğ²Ğ°Ñ€Ğ¾Ğ²
    List<PurchaseResponse> purchasedProducts = productClient.purchaseProducts(request.products());

    // 3. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ°ĞºĞ°Ğ·Ğ°
    Order order = repository.save(mapper.toOrder(request));

    // 4. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Order Lines
    for (PurchaseRequest purchaseRequest : request.products()) {
        orderLineService.saveOrderLine(
                new OrderLineRequest(null, order.getId(), purchaseRequest.productId(), purchaseRequest.quantity())
        );
    }

    // 5. ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶Ğ°
    PaymentRequest paymentRequest = new PaymentRequest(
            request.amount(), request.paymentMethod(), order.getId(), order.getReference(), customer
    );
    paymentClient.requestOrderPayment(paymentRequest);

    // 6. ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ
    orderProducer.sendOrderConfirmation(
            new OrderConfirmation(request.reference(), request.amount(), request.paymentMethod(), customer, purchasedProducts)
    );

    return order.getId();
}
```

## ğŸ”— Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ Ğ²Ğ½ĞµÑˆĞ½Ğ¸Ğ¼Ğ¸ ÑĞµÑ€Ğ²Ğ¸ÑĞ°Ğ¼Ğ¸

### Customer Service (Ñ‡ĞµÑ€ĞµĞ· Feign Client)
```java
@FeignClient(name = "customer-service", url = "${application.config.customer-url}")
public interface CustomerClient {
    @GetMapping("/{customer-id}")
    Optional<CustomerResponse> findCustomerById(@PathVariable("customer-id") String customerId);
}
```

### Product Service (Ñ‡ĞµÑ€ĞµĞ· RestTemplate)
```java
@Service
public class ProductClient {
    
    @Value("${application.config.product-url}")
    private String productUrl;
    
    public List<PurchaseResponse> purchaseProducts(List<PurchaseRequest> requestBody) {
        HttpHeaders headers = new HttpHeaders();
        headers.set(CONTENT_TYPE, APPLICATION_JSON_VALUE);
        
        HttpEntity<List<PurchaseRequest>> requestEntity = new HttpEntity<>(requestBody, headers);
        
        ResponseEntity<List<PurchaseResponse>> responseEntity = restTemplate.exchange(
                productUrl + "/purchase", POST, requestEntity, 
                new ParameterizedTypeReference<>() {}
        );
        
        return responseEntity.getBody();
    }
}
```

### Payment Service (Ñ‡ĞµÑ€ĞµĞ· Feign Client)
```java
@FeignClient(name = "product-service", url = "${application.config.payment-url}")
public interface PaymentClient {
    @PostMapping
    Integer requestOrderPayment(@RequestBody PaymentRequest request);
}
```

## ğŸ“¨ Kafka Integration

### OrderProducer
```java
@Service
public class OrderProducer {
    
    private final KafkaTemplate<String, OrderConfirmation> kafkaTemplate;
    
    public void sendOrderConfirmation(OrderConfirmation orderConfirmation) {
        Message<OrderConfirmation> message = MessageBuilder
                .withPayload(orderConfirmation)
                .setHeader(TOPIC, "order-topic")
                .build();
        
        kafkaTemplate.send(message);
    }
}
```

### OrderConfirmation Event
```java
public record OrderConfirmation(
    String orderReference,
    BigDecimal totalAmount,
    PaymentMethod paymentMethod,
    CustomerResponse customer,
    List<PurchaseResponse> products
) {}
```

### Kafka Topic Configuration
```java
@Configuration
public class KafkaOrderTopicConfig {
    
    @Bean
    public NewTopic orderTopic() {
        return TopicBuilder
                .name("order-topic")
                .build();
    }
}
```

## ğŸ” Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

### OrderRequest
- `amount` - Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ğ¿Ğ¾Ğ»Ğ¾Ğ¶Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¼ Ñ‡Ğ¸ÑĞ»Ğ¾Ğ¼
- `paymentMethod` - Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğµ Ğ¿Ğ¾Ğ»Ğµ
- `customerId` - Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğµ Ğ¿Ğ¾Ğ»Ğµ, Ğ½Ğµ Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ±Ñ‹Ñ‚ÑŒ Ğ¿ÑƒÑÑ‚Ñ‹Ğ¼
- `products` - Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ ÑĞ¿Ğ¸ÑĞ¾Ğº Ñ Ğ¼Ğ¸Ğ½Ğ¸Ğ¼ÑƒĞ¼ Ğ¾Ğ´Ğ½Ğ¸Ğ¼ Ñ‚Ğ¾Ğ²Ğ°Ñ€Ğ¾Ğ¼

### PurchaseRequest
- `productId` - Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğµ Ğ¿Ğ¾Ğ»Ğµ
- `quantity` - Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ğ¿Ğ¾Ğ»Ğ¾Ğ¶Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¼ Ñ‡Ğ¸ÑĞ»Ğ¾Ğ¼

### ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ğ¸
```json
{
  "title": "ĞÑˆĞ¸Ğ±ĞºĞ° Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ğ¸",
  "errors": {
    "amount": ["Order amount should be positive"],
    "customerId": ["Customer should be present"],
    "products": ["You should at least purchase one product"]
  }
}
```

## ğŸ”§ ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº

### Ğ¢Ğ¸Ğ¿Ñ‹ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº

1. **BusinessException (404)**
   ```json
   "Cannot create order:: No customer exists with the provided ID"
   ```

2. **EntityNotFoundException (404)**
   ```json
   "No order found with the provided ID: 15"
   ```

3. **Product Purchase Exception (400)**
   ```json
   "An error occurred while processing the products purchase: 400 BAD_REQUEST"
   ```

4. **ValidationException (400)**
   ```json
   {
     "title": "ĞÑˆĞ¸Ğ±ĞºĞ° Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ğ¸",
     "errors": {
       "amount": ["Order amount should be positive"]
     }
   }
   ```

## ğŸ“Š ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³

### Health Check
```http
GET /actuator/health
```

### Kafka Health Check
Spring Boot Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğº Kafka:
```json
{
  "status": "UP",
  "components": {
    "kafka": {
      "status": "UP"
    }
  }
}
```

## ğŸ› Ğ£ÑÑ‚Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ½ĞµĞ¿Ğ¾Ğ»Ğ°Ğ´Ğ¾Ğº

### Ğ§Ğ°ÑÑ‚Ñ‹Ğµ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñ‹

1. **Customer Service Ğ½ĞµĞ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½**
    - Ğ£Ğ±ĞµĞ´Ğ¸Ñ‚ĞµÑÑŒ, Ñ‡Ñ‚Ğ¾ Customer Service Ğ·Ğ°Ğ¿ÑƒÑ‰ĞµĞ½ Ğ½Ğ° Ğ¿Ğ¾Ñ€Ñ‚Ñƒ 8090
    - ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ customer-url Ğ² Config Server

2. **Product Service Ğ½ĞµĞ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½**
    - Ğ£Ğ±ĞµĞ´Ğ¸Ñ‚ĞµÑÑŒ, Ñ‡Ñ‚Ğ¾ Product Service Ğ·Ğ°Ğ¿ÑƒÑ‰ĞµĞ½ Ğ½Ğ° Ğ¿Ğ¾Ñ€Ñ‚Ñƒ 8050
    - ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ product-url Ğ² Config Server

3. **Kafka Ğ½ĞµĞ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½**
    - Ğ£Ğ±ĞµĞ´Ğ¸Ñ‚ĞµÑÑŒ, Ñ‡Ñ‚Ğ¾ Kafka Ğ·Ğ°Ğ¿ÑƒÑ‰ĞµĞ½
    - ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ Kafka Ğ² application.yml

4. **PostgreSQL Ğ½ĞµĞ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½**
    - Ğ£Ğ±ĞµĞ´Ğ¸Ñ‚ĞµÑÑŒ, Ñ‡Ñ‚Ğ¾ PostgreSQL Ğ·Ğ°Ğ¿ÑƒÑ‰ĞµĞ½ Ğ½Ğ° Ğ¿Ğ¾Ñ€Ñ‚Ñƒ 5555
    - ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ ÑÑƒÑ‰ĞµÑÑ‚Ğ²Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ±Ğ°Ğ·Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… 'order'

5. **Feign Client Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸**
    - ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ² Ğ² Eureka
    - Ğ£Ğ±ĞµĞ´Ğ¸Ñ‚ĞµÑÑŒ Ğ² ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ğ¾ÑÑ‚Ğ¸ URL Ğ² ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸

## ğŸ“ Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°

```
order/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main/
â”‚   â”‚   â”œâ”€â”€ java/
â”‚   â”‚   â”‚   â””â”€â”€ kg/manurov/ecommerce/
â”‚   â”‚   â”‚       â”œâ”€â”€ configs/
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ KafkaOrderTopicConfig.java
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ RestTemplate.java
â”‚   â”‚   â”‚       â”œâ”€â”€ controller/
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ OrderController.java
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ OrderLineController.java
â”‚   â”‚   â”‚       â”œâ”€â”€ dto/
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ order/
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ orderLine/
â”‚   â”‚   â”‚       â”œâ”€â”€ errors/
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ BusinessException.java
â”‚   â”‚   â”‚       â”œâ”€â”€ feign/
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ customer/
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ payment/
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ product/
â”‚   â”‚   â”‚       â”œâ”€â”€ handler/
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ ErrorResponseBody.java
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ GlobalExceptionHandler.java
â”‚   â”‚   â”‚       â”œâ”€â”€ kafka/
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ OrderConfirmation.java
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ OrderProducer.java
â”‚   â”‚   â”‚       â”œâ”€â”€ mapper/
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ OrderMapper.java
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ OrderLineMapper.java
â”‚   â”‚   â”‚       â”œâ”€â”€ order/
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ Order.java
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ OrderLine.java
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ PaymentMethod.java
â”‚   â”‚   â”‚       â”œâ”€â”€ repositories/
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ OrderRepository.java
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ OrderLineRepository.java
â”‚   â”‚   â”‚       â”œâ”€â”€ services/
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ ErrorService.java
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ OrderService.java
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ OrderLineService.java
â”‚   â”‚   â”‚       â””â”€â”€ OrderApplication.java
â”‚   â”‚   â””â”€â”€ resources/
â”‚   â”‚       â””â”€â”€ application.yml
â”‚   â””â”€â”€ test/
â”œâ”€â”€ target/
â”œâ”€â”€ pom.xml
â””â”€â”€ README.md
```